"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const ec2 = require("@aws-cdk/aws-ec2");
const cdk = require("@aws-cdk/core");
const ecs = require("../../lib");
const app = new cdk.App();
const stack = new cdk.Stack(app, 'aws-ecs-integ-runtime');
const vpc = new ec2.Vpc(stack, 'Vpc', { maxAzs: 2 });
const cluster = new ecs.Cluster(stack, 'FargateCluster', {
    vpc,
});
const taskDefinitionwindows = new ecs.FargateTaskDefinition(stack, 'TaskDefWindows', {
    runtimePlatform: {
        operatingSystemFamily: ecs.OperatingSystemFamily.WINDOWS_SERVER_2019_CORE,
        cpuArchitecture: ecs.CpuArchitecture.X86_64,
    },
    cpu: 1024,
    memoryLimitMiB: 2048,
});
const taskDefinitiongraviton2 = new ecs.FargateTaskDefinition(stack, 'TaskDefGraviton2', {
    runtimePlatform: {
        operatingSystemFamily: ecs.OperatingSystemFamily.LINUX,
        cpuArchitecture: ecs.CpuArchitecture.ARM64,
    },
    cpu: 256,
    memoryLimitMiB: 1024,
});
taskDefinitionwindows.addContainer('windowsservercore', {
    logging: ecs.LogDriver.awsLogs({ streamPrefix: 'win-iis-on-fargate' }),
    portMappings: [{ containerPort: 80 }],
    image: ecs.ContainerImage.fromRegistry('mcr.microsoft.com/windows/servercore/iis:windowsservercore-ltsc2019'),
});
taskDefinitiongraviton2.addContainer('webarm64', {
    logging: ecs.LogDriver.awsLogs({ streamPrefix: 'graviton2-on-fargate' }),
    portMappings: [{ containerPort: 80 }],
    image: ecs.ContainerImage.fromRegistry('public.ecr.aws/nginx/nginx:latest-arm64v8'),
});
new ecs.FargateService(stack, 'FargateServiceWindowsRuntime', {
    cluster,
    taskDefinition: taskDefinitionwindows,
});
new ecs.FargateService(stack, 'FargateServiceGraviton2Runtime', {
    cluster,
    taskDefinition: taskDefinitiongraviton2,
});
app.synth();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW50ZWcucnVudGltZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImludGVnLnJ1bnRpbWUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSx3Q0FBd0M7QUFDeEMscUNBQXFDO0FBQ3JDLGlDQUFpQztBQUVqQyxNQUFNLEdBQUcsR0FBRyxJQUFJLEdBQUcsQ0FBQyxHQUFHLEVBQUUsQ0FBQztBQUMxQixNQUFNLEtBQUssR0FBRyxJQUFJLEdBQUcsQ0FBQyxLQUFLLENBQUMsR0FBRyxFQUFFLHVCQUF1QixDQUFDLENBQUM7QUFFMUQsTUFBTSxHQUFHLEdBQUcsSUFBSSxHQUFHLENBQUMsR0FBRyxDQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsRUFBRSxNQUFNLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQztBQUdyRCxNQUFNLE9BQU8sR0FBRyxJQUFJLEdBQUcsQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFFLGdCQUFnQixFQUFFO0lBQ3ZELEdBQUc7Q0FDSixDQUFDLENBQUM7QUFFSCxNQUFNLHFCQUFxQixHQUFHLElBQUksR0FBRyxDQUFDLHFCQUFxQixDQUFDLEtBQUssRUFBRSxnQkFBZ0IsRUFBRTtJQUNuRixlQUFlLEVBQUU7UUFDZixxQkFBcUIsRUFBRSxHQUFHLENBQUMscUJBQXFCLENBQUMsd0JBQXdCO1FBQ3pFLGVBQWUsRUFBRSxHQUFHLENBQUMsZUFBZSxDQUFDLE1BQU07S0FDNUM7SUFDRCxHQUFHLEVBQUUsSUFBSTtJQUNULGNBQWMsRUFBRSxJQUFJO0NBQ3JCLENBQUMsQ0FBQztBQUVILE1BQU0sdUJBQXVCLEdBQUcsSUFBSSxHQUFHLENBQUMscUJBQXFCLENBQUMsS0FBSyxFQUFFLGtCQUFrQixFQUFFO0lBQ3ZGLGVBQWUsRUFBRTtRQUNmLHFCQUFxQixFQUFFLEdBQUcsQ0FBQyxxQkFBcUIsQ0FBQyxLQUFLO1FBQ3RELGVBQWUsRUFBRSxHQUFHLENBQUMsZUFBZSxDQUFDLEtBQUs7S0FDM0M7SUFDRCxHQUFHLEVBQUUsR0FBRztJQUNSLGNBQWMsRUFBRSxJQUFJO0NBQ3JCLENBQUMsQ0FBQztBQUVILHFCQUFxQixDQUFDLFlBQVksQ0FBQyxtQkFBbUIsRUFBRTtJQUN0RCxPQUFPLEVBQUUsR0FBRyxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsRUFBRSxZQUFZLEVBQUUsb0JBQW9CLEVBQUUsQ0FBQztJQUN0RSxZQUFZLEVBQUUsQ0FBQyxFQUFFLGFBQWEsRUFBRSxFQUFFLEVBQUUsQ0FBQztJQUNyQyxLQUFLLEVBQUUsR0FBRyxDQUFDLGNBQWMsQ0FBQyxZQUFZLENBQUMscUVBQXFFLENBQUM7Q0FDOUcsQ0FBQyxDQUFDO0FBRUgsdUJBQXVCLENBQUMsWUFBWSxDQUFDLFVBQVUsRUFBRTtJQUMvQyxPQUFPLEVBQUUsR0FBRyxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsRUFBRSxZQUFZLEVBQUUsc0JBQXNCLEVBQUUsQ0FBQztJQUN4RSxZQUFZLEVBQUUsQ0FBQyxFQUFFLGFBQWEsRUFBRSxFQUFFLEVBQUUsQ0FBQztJQUNyQyxLQUFLLEVBQUUsR0FBRyxDQUFDLGNBQWMsQ0FBQyxZQUFZLENBQUMsMkNBQTJDLENBQUM7Q0FDcEYsQ0FBQyxDQUFDO0FBRUgsSUFBSSxHQUFHLENBQUMsY0FBYyxDQUFDLEtBQUssRUFBRSw4QkFBOEIsRUFBRTtJQUM1RCxPQUFPO0lBQ1AsY0FBYyxFQUFFLHFCQUFxQjtDQUN0QyxDQUFDLENBQUM7QUFFSCxJQUFJLEdBQUcsQ0FBQyxjQUFjLENBQUMsS0FBSyxFQUFFLGdDQUFnQyxFQUFFO0lBQzlELE9BQU87SUFDUCxjQUFjLEVBQUUsdUJBQXVCO0NBQ3hDLENBQUMsQ0FBQztBQUVILEdBQUcsQ0FBQyxLQUFLLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGVjMiBmcm9tICdAYXdzLWNkay9hd3MtZWMyJztcbmltcG9ydCAqIGFzIGNkayBmcm9tICdAYXdzLWNkay9jb3JlJztcbmltcG9ydCAqIGFzIGVjcyBmcm9tICcuLi8uLi9saWInO1xuXG5jb25zdCBhcHAgPSBuZXcgY2RrLkFwcCgpO1xuY29uc3Qgc3RhY2sgPSBuZXcgY2RrLlN0YWNrKGFwcCwgJ2F3cy1lY3MtaW50ZWctcnVudGltZScpO1xuXG5jb25zdCB2cGMgPSBuZXcgZWMyLlZwYyhzdGFjaywgJ1ZwYycsIHsgbWF4QXpzOiAyIH0pO1xuXG5cbmNvbnN0IGNsdXN0ZXIgPSBuZXcgZWNzLkNsdXN0ZXIoc3RhY2ssICdGYXJnYXRlQ2x1c3RlcicsIHtcbiAgdnBjLFxufSk7XG5cbmNvbnN0IHRhc2tEZWZpbml0aW9ud2luZG93cyA9IG5ldyBlY3MuRmFyZ2F0ZVRhc2tEZWZpbml0aW9uKHN0YWNrLCAnVGFza0RlZldpbmRvd3MnLCB7XG4gIHJ1bnRpbWVQbGF0Zm9ybToge1xuICAgIG9wZXJhdGluZ1N5c3RlbUZhbWlseTogZWNzLk9wZXJhdGluZ1N5c3RlbUZhbWlseS5XSU5ET1dTX1NFUlZFUl8yMDE5X0NPUkUsXG4gICAgY3B1QXJjaGl0ZWN0dXJlOiBlY3MuQ3B1QXJjaGl0ZWN0dXJlLlg4Nl82NCxcbiAgfSxcbiAgY3B1OiAxMDI0LFxuICBtZW1vcnlMaW1pdE1pQjogMjA0OCxcbn0pO1xuXG5jb25zdCB0YXNrRGVmaW5pdGlvbmdyYXZpdG9uMiA9IG5ldyBlY3MuRmFyZ2F0ZVRhc2tEZWZpbml0aW9uKHN0YWNrLCAnVGFza0RlZkdyYXZpdG9uMicsIHtcbiAgcnVudGltZVBsYXRmb3JtOiB7XG4gICAgb3BlcmF0aW5nU3lzdGVtRmFtaWx5OiBlY3MuT3BlcmF0aW5nU3lzdGVtRmFtaWx5LkxJTlVYLFxuICAgIGNwdUFyY2hpdGVjdHVyZTogZWNzLkNwdUFyY2hpdGVjdHVyZS5BUk02NCxcbiAgfSxcbiAgY3B1OiAyNTYsXG4gIG1lbW9yeUxpbWl0TWlCOiAxMDI0LFxufSk7XG5cbnRhc2tEZWZpbml0aW9ud2luZG93cy5hZGRDb250YWluZXIoJ3dpbmRvd3NzZXJ2ZXJjb3JlJywge1xuICBsb2dnaW5nOiBlY3MuTG9nRHJpdmVyLmF3c0xvZ3MoeyBzdHJlYW1QcmVmaXg6ICd3aW4taWlzLW9uLWZhcmdhdGUnIH0pLFxuICBwb3J0TWFwcGluZ3M6IFt7IGNvbnRhaW5lclBvcnQ6IDgwIH1dLFxuICBpbWFnZTogZWNzLkNvbnRhaW5lckltYWdlLmZyb21SZWdpc3RyeSgnbWNyLm1pY3Jvc29mdC5jb20vd2luZG93cy9zZXJ2ZXJjb3JlL2lpczp3aW5kb3dzc2VydmVyY29yZS1sdHNjMjAxOScpLFxufSk7XG5cbnRhc2tEZWZpbml0aW9uZ3Jhdml0b24yLmFkZENvbnRhaW5lcignd2ViYXJtNjQnLCB7XG4gIGxvZ2dpbmc6IGVjcy5Mb2dEcml2ZXIuYXdzTG9ncyh7IHN0cmVhbVByZWZpeDogJ2dyYXZpdG9uMi1vbi1mYXJnYXRlJyB9KSxcbiAgcG9ydE1hcHBpbmdzOiBbeyBjb250YWluZXJQb3J0OiA4MCB9XSxcbiAgaW1hZ2U6IGVjcy5Db250YWluZXJJbWFnZS5mcm9tUmVnaXN0cnkoJ3B1YmxpYy5lY3IuYXdzL25naW54L25naW54OmxhdGVzdC1hcm02NHY4JyksXG59KTtcblxubmV3IGVjcy5GYXJnYXRlU2VydmljZShzdGFjaywgJ0ZhcmdhdGVTZXJ2aWNlV2luZG93c1J1bnRpbWUnLCB7XG4gIGNsdXN0ZXIsXG4gIHRhc2tEZWZpbml0aW9uOiB0YXNrRGVmaW5pdGlvbndpbmRvd3MsXG59KTtcblxubmV3IGVjcy5GYXJnYXRlU2VydmljZShzdGFjaywgJ0ZhcmdhdGVTZXJ2aWNlR3Jhdml0b24yUnVudGltZScsIHtcbiAgY2x1c3RlcixcbiAgdGFza0RlZmluaXRpb246IHRhc2tEZWZpbml0aW9uZ3Jhdml0b24yLFxufSk7XG5cbmFwcC5zeW50aCgpOyJdfQ==